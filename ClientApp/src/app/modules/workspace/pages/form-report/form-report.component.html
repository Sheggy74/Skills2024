<p-dialog modal="true" [(visible)]="visible">
    <p-table [value]="tasks"
        [(selection)]="selectedTasks"
        [paginator]="true"
        [rows]=5
        (onRowSelect)="onCheckboxChange($event)"
        (onRowUnselect)="onCheckboxChangeRemove($event)">
        
        <ng-template pTemplate="header">
            <tr>
            <th style="width: 4rem;"> <p-tableCheckbox></p-tableCheckbox></th>
              <th>Задача</th>
              <th>Дата</th>
              <th>Кр. комментарий</th>
              <th>% выполнения задачи</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-task>
            <tr>
                <td>
                    <p-tableCheckbox [value]="task"/>
                </td>
              <td>{{task.name}}</td>
              <td>
                <p-calendar
                    inputId="calendar"
                    [(ngModel)]="task.date"
                    modal="true"    
                ></p-calendar>         
              </td>
              <td>
                <input type="text" pInputText [(ngModel)]="task.description"
                [ngClass]="{error:task.validDescription}" (keyup)="inputDescription($event,task)">
                <div *ngIf="task.validDescription" style="color: red;">Поле не должно быть пустым</div>
              </td>
              <td>
                <p-inputNumber
                    [(ngModel)]="task.percent"
                    mode="decimal"
                    [max]="100"
                    [min]="0"
                    [ngClass]="{error:task.validPercent}"
                    (onInput)="inputPercent($event,task)"
                    suffix="%"
                    required
                    showClear="true"
                ></p-inputNumber>
              <div *ngIf="task.percent>100 || task.percent+task.oldPercent>100" style="color: red;">
                Объем работ не должен превыщать 100% ({{task.percent+task.oldPercent}}%)
              </div>
              </td>
            </tr>
          </ng-template>
    </p-table>

    <p-button (click)="save()" [disabled]="disable">Сохранить</p-button>
</p-dialog>
