<div class="max-width-full max-h-screen">
  <div *ngIf="isLoadingProject && isLoadingTask" class="custom-skeleton p-4">
    <p-skeleton width="100%" height="150px"></p-skeleton>
  </div>
  <p-card *ngIf="!isLoadingProject">
    <ng-template pTemplate="header">
      <div class="flex items-center p-4 pl-5 gap-10">
        <span class="font-bold text-3xl capitalize">
          <a class="text-blue-600 hover:underline" routerLink="/projects">проекты/</a>{{projectName}}
        </span>
        <button pButton pRipple *ngIf="isManagerOrAdmin"
          (click)="this.projectService.selectedPrject.next(project);add.showDialog()" icon="pi pi-pencil"
          class="p-button-lg p-button-rounded p-button-text" label="" pTooltip="Добавить пользователя"
          [showDelay]="1000"></button>
        <!-- <p-button label="Toggle Sidebar" icon="pi pi-bars" (onClick)="isSidebarVisible = !isSidebarVisible"></p-button> -->
        <!-- <button pButton pRipple icon="pi pi-calendar" (click)="clnd.openDialog()"></button> -->
        <p-avatarGroup styleClass="mb-3">
          <ng-container *ngFor="let user of project.users?.slice(5); index as i ">
            <p-avatar *ngIf="user.photo_url == null && i <= 5" [label]="user.first_name ? user.first_name[0].toUpperCase() : 'A'"
              class="mr-2" shape="circle" />
            <p-avatar *ngIf="user.photo_url != null && i <= 5" [image]="'http://localhost:8000/storage/' + user.photo_url"
              class="mr-2" shape="circle" />
            <p-avatar *ngIf="i > 5" [label]="(project.users.length - 5).toString()"
              class="mr-2" shape="circle" />
          </ng-container>
        </p-avatarGroup>
      </div>
    </ng-template>
    <div class="flex gap-10 items-center">
      <button pButton pRipple class="p-button-rounded p-button-primary p-button-text" *ngIf="isManagerOrAdmin"
        label="Добавить задачу" icon="pi pi-plus" (click)="createTaskDialog.showDialog()"></button>
      <div *ngIf="!isManagerOrAdmin" class="flex gap-2 items-center">
        <p-checkbox [(ngModel)]="isOnlyExecutorsTasks"></p-checkbox>
        <label for="binary">Показывать только мои задачи</label>
      </div>
      <div *ngIf="isManagerOrAdmin" class="flex gap-2 items-center">
        <!-- <p-checkbox [(ngModel)]="isOnlyExecutorsTasks"></p-checkbox>
      <label for="binary">Показывать только мои задачи</label> -->
      </div>
    </div>

    <p-tabMenu [model]="items" [activeItem]="activeItem" (activeItemChange)="onActiveItemChange($event);" />

    <app-task-table [tasks]="tasks" *ngIf="activeItem == items[0]"></app-task-table>
  </p-card>

  <app-create-task [projectId]="projectId" #createTaskDialog (createTask)="addTask($event)"></app-create-task>
  <app-calendar #clnd *ngIf="activeItem == items[1]" [visibleClnd]="visibleClnd"></app-calendar>
  <!-- <app-create-task [projectId]="projectId" #createTaskDialog (createTask)="addTask($event)"></app-create-task> -->
  <app-add-project #add></app-add-project>


</div>